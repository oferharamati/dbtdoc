{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-19T13:03:57.618609Z", "invocation_id": "ab68bdbf-d2a9-4b3d-83d2-83dabbe29196", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.086063Z", "completed_at": "2025-02-19T13:03:57.092251Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.092722Z", "completed_at": "2025-02-19T13:03:57.092732Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007597208023071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.blocks_categories", "compiled": true, "compiled_code": "select\n   *\nfrom OFER_DB.blocks.categories", "relation_name": "OFER_DB.DBT_ds.blocks_categories", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.094220Z", "completed_at": "2025-02-19T13:03:57.097536Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.097837Z", "completed_at": "2025-02-19T13:03:57.097843Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004338741302490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.blocks_plans", "compiled": true, "compiled_code": "select\n   *\nfrom OFER_DB.blocks.plans", "relation_name": "OFER_DB.DBT_ds.blocks_plans", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.099226Z", "completed_at": "2025-02-19T13:03:57.146008Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.146361Z", "completed_at": "2025-02-19T13:03:57.146368Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0477750301361084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.blocks_prices", "compiled": true, "compiled_code": "select\n   *\nfrom OFER_DB.blocks.prices", "relation_name": "OFER_DB.DBT_ds.blocks_prices", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.147789Z", "completed_at": "2025-02-19T13:03:57.149526Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.149740Z", "completed_at": "2025-02-19T13:03:57.149745Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026328563690185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.blocks_products", "compiled": true, "compiled_code": "select\n   *\nfrom OFER_DB.blocks.products", "relation_name": "OFER_DB.DBT_ds.blocks_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.150768Z", "completed_at": "2025-02-19T13:03:57.152434Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.152624Z", "completed_at": "2025-02-19T13:03:57.152627Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023088455200195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.blocks_productsinstall", "compiled": true, "compiled_code": "select\n   *\nfrom OFER_DB.blocks.productinstalls", "relation_name": "OFER_DB.DBT_ds.blocks_productsinstall", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.153761Z", "completed_at": "2025-02-19T13:03:57.155267Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.155469Z", "completed_at": "2025-02-19T13:03:57.155472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023040771484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.blocks_subscriptions", "compiled": true, "compiled_code": "select\n   *\nfrom OFER_DB.blocks.subscriptions", "relation_name": "OFER_DB.DBT_ds.blocks_subscriptions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.156569Z", "completed_at": "2025-02-19T13:03:57.158117Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.158312Z", "completed_at": "2025-02-19T13:03:57.158315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023241043090820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.google_ad_groups", "compiled": true, "compiled_code": "select\n        id as ad_groups_id, \n        name as ad_groups_name,\n        campaign_id,\n        uuid_ts\nfrom segment_events.google_ads.ad_groups", "relation_name": "OFER_DB.DBT_ds.google_ad_groups", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.159407Z", "completed_at": "2025-02-19T13:03:57.161177Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.161387Z", "completed_at": "2025-02-19T13:03:57.161391Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025467872619628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.google_campaigns", "compiled": true, "compiled_code": "select\n        id as campaign_id, \n        name as campaign_name, \n        status, \n        start_date\n    \n\n--from segment_events.blocks_web_prod.users\nfrom segment_events.google_ads.campaigns", "relation_name": "OFER_DB.DBT_ds.google_campaigns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.162476Z", "completed_at": "2025-02-19T13:03:57.164724Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.164983Z", "completed_at": "2025-02-19T13:03:57.164987Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003046274185180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.google_keywords", "compiled": true, "compiled_code": "select \n    c.id as  campaign_id,  \n    c.name as campaign_name, \n    g.id as ad_group_id, \n    g.name as ad_group_name, \n    k.original_id as keyword_id, \n    k.text as keyword\n    from segment_events.google_ads.campaigns as c\n    inner join segment_events.google_ads.ad_groups as g on c.id = g.campaign_id\n    inner join segment_events.google_ads.keywords as k on g.id = k.ad_group_id", "relation_name": "OFER_DB.DBT_ds.google_keywords", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.166050Z", "completed_at": "2025-02-19T13:03:57.167571Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.167757Z", "completed_at": "2025-02-19T13:03:57.167759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002216815948486328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.google_keywords_performance", "compiled": true, "compiled_code": "select campaign_id, \n    ad_group_id, \n    original_keyword_id as keyword_id, \n    criteria, \n    date_start, \n    date_stop,\n    impressions, \n    clicks , \n    average_cost/1000000 as average_cost   \nfrom segment_events.google_ads.keyword_performance_reports", "relation_name": "OFER_DB.DBT_ds.google_keywords_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.168799Z", "completed_at": "2025-02-19T13:03:57.170291Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.170476Z", "completed_at": "2025-02-19T13:03:57.170478Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002207040786743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.server_tracks", "compiled": true, "compiled_code": "select\n   *\n\n--from segment_events.blocks_server_prod.tracks\nfrom segment_events.blocks_server_production.tracks", "relation_name": "OFER_DB.DBT_ds.server_tracks", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.171516Z", "completed_at": "2025-02-19T13:03:57.173214Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.173484Z", "completed_at": "2025-02-19T13:03:57.173487Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025582313537597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.stripe_customers", "compiled": true, "compiled_code": "select\n   *\nfrom segment_events.stripe_prod.customers", "relation_name": "OFER_DB.DBT_ds.stripe_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.174630Z", "completed_at": "2025-02-19T13:03:57.176069Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.176248Z", "completed_at": "2025-02-19T13:03:57.176250Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002132415771484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.stripe_plans", "compiled": true, "compiled_code": "select\n   *\nfrom segment_events.stripe_prod.plans", "relation_name": "OFER_DB.DBT_ds.stripe_plans", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.177186Z", "completed_at": "2025-02-19T13:03:57.178786Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.178981Z", "completed_at": "2025-02-19T13:03:57.178983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022559165954589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.stripe_products", "compiled": true, "compiled_code": "select\n   *\nfrom segment_events.stripe_prod.products", "relation_name": "OFER_DB.DBT_ds.stripe_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.179939Z", "completed_at": "2025-02-19T13:03:57.182925Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.183113Z", "completed_at": "2025-02-19T13:03:57.183116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037069320678710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.stripe_subscriptions", "compiled": true, "compiled_code": "select\n   *\nfrom segment_events.stripe_prod.subscriptions", "relation_name": "OFER_DB.DBT_ds.stripe_subscriptions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.184247Z", "completed_at": "2025-02-19T13:03:57.185920Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.186118Z", "completed_at": "2025-02-19T13:03:57.186121Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002414703369140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.web_accounts", "compiled": true, "compiled_code": "select\n   id as account_id, \n   name as account_name\n  \n\nfrom segment_events.blocks_web_prod.accounts", "relation_name": "OFER_DB.DBT_ds.web_accounts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.187010Z", "completed_at": "2025-02-19T13:03:57.188731Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.188930Z", "completed_at": "2025-02-19T13:03:57.188933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002353191375732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.web_identifies", "compiled": true, "compiled_code": "select\n  *\nfrom segment_events.blocks_web_prod.identifies", "relation_name": "OFER_DB.DBT_ds.web_identifies", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.189882Z", "completed_at": "2025-02-19T13:03:57.191663Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.191992Z", "completed_at": "2025-02-19T13:03:57.191995Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025572776794433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.web_pages", "compiled": true, "compiled_code": "select\n   *\n\n--from segment_events.blocks_web_prod.\nfrom segment_events.blocks_web_prod.pages", "relation_name": "OFER_DB.DBT_ds.web_pages", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.193027Z", "completed_at": "2025-02-19T13:03:57.194987Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.195205Z", "completed_at": "2025-02-19T13:03:57.195208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002626180648803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.web_tracks", "compiled": true, "compiled_code": "select\n   *\n\n--from segment_events.blocks_web_prod.tracks\nfrom segment_events.blocks_web_prod.tracks", "relation_name": "OFER_DB.DBT_ds.web_tracks", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.196213Z", "completed_at": "2025-02-19T13:03:57.197756Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.197939Z", "completed_at": "2025-02-19T13:03:57.197942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002190828323364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.web_users", "compiled": true, "compiled_code": "select\n   id as user_id, \n   first_name, \n   last_name, \n   email, \n   phone, \n   signup_data_waiting_list_survey_goal as goal, \n   signup_data_is_work_email as is_work\n\n--from segment_events.blocks_web_prod.users\nfrom segment_events.blocks_web_prod.users", "relation_name": "OFER_DB.DBT_ds.web_users", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.199000Z", "completed_at": "2025-02-19T13:03:57.207274Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.207636Z", "completed_at": "2025-02-19T13:03:57.207640Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009170293807983398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.blocksdbt.source_not_null_blocks_web_prod_users_id.24cb481298", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom segment_events.blocks_web_prod.users\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.208650Z", "completed_at": "2025-02-19T13:03:57.212382Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.212594Z", "completed_at": "2025-02-19T13:03:57.212597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004400968551635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.blocksdbt.source_unique_blocks_web_prod_users_id.968cf56cb0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom segment_events.blocks_web_prod.users\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.213507Z", "completed_at": "2025-02-19T13:03:57.216172Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.216389Z", "completed_at": "2025-02-19T13:03:57.216392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033118724822998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.blocksdbt.not_null_google_campaigns_campaign_id.e2d32215e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom OFER_DB.DBT_ds.google_campaigns\nwhere campaign_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.217305Z", "completed_at": "2025-02-19T13:03:57.219774Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.219986Z", "completed_at": "2025-02-19T13:03:57.219989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031120777130126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.blocksdbt.unique_google_campaigns_campaign_id.9fc967906b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    campaign_id as unique_field,\n    count(*) as n_records\n\nfrom OFER_DB.DBT_ds.google_campaigns\nwhere campaign_id is not null\ngroup by campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.221069Z", "completed_at": "2025-02-19T13:03:57.222940Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.223135Z", "completed_at": "2025-02-19T13:03:57.223137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026459693908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.keywords_data", "compiled": true, "compiled_code": "select d.campaign_id, \n        d.campaign_name, \n        d.ad_group_name,\n        d.ad_group_id, \n        date_start, \n        date_stop, \n        keyword, \n        criteria, \n        impressions, \n        clicks, \n        average_cost\nfrom   OFER_DB.DBT_ds.google_keywords_performance f\nleft join OFER_DB.DBT_ds.google_keywords d on d.keyword_id = f.keyword_id \nwhere  f.ad_group_id = d.ad_group_id \nand     f.campaign_id = d.campaign_id", "relation_name": "OFER_DB.DBT_intermediate.keywords_data", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.224121Z", "completed_at": "2025-02-19T13:03:57.227529Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.227796Z", "completed_at": "2025-02-19T13:03:57.227799Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004165172576904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.subscriptions", "compiled": true, "compiled_code": "select s.start_date,\n            s.status, \n            s.canceled_at, \n            p.interval, \n            p.amount/100 amount , \n            c.email, \n            pr.name \n    from OFER_DB.DBT_ds.stripe_subscriptions s\n    left join OFER_DB.DBT_ds.stripe_plans p on s.plan_id = p.id\n    left join OFER_DB.DBT_ds.stripe_customers c on s.customer_id = c.id\n    left join OFER_DB.DBT_ds.stripe_products pr on p.product = pr.id\n    where s.status = 'active'\n    order by s.start_date desc", "relation_name": "OFER_DB.DBT_intermediate.subscriptions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.228910Z", "completed_at": "2025-02-19T13:03:57.230443Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.230630Z", "completed_at": "2025-02-19T13:03:57.230633Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002274036407470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.funnel_pages", "compiled": true, "compiled_code": "select \n    UUID_TS,  \n    UTMS_CAMPAIGNID campaign_id, \n    UTMS_ADGROUPID ad_group_id, \n    UTMS_UTM_CONTENT keyword, \n    title, \n    path , \n    anonymous_id , \n    user_id, \n    url,  \n    iff(title like 'Blocks LPs', 1, 0) visitor, \n    iff (path like '/auth/waiting-list', 1, 0) page_clicks\n\n    from OFER_DB.DBT_ds.web_pages\n    \n    qualify  ROW_NUMBER() OVER (PARTITION BY campaign_id, anonymous_id, ad_group_id, keyword,  title, path order by campaign_id, anonymous_id,ad_group_id, keyword, title, path) = 1\n    order by utms_campaignid , UTMS_ADGROUPID, UTMS_UTM_CONTENT,  uuid_ts", "relation_name": "OFER_DB.DBT_intermediate.funnel_pages", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.231720Z", "completed_at": "2025-02-19T13:03:57.233969Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.234154Z", "completed_at": "2025-02-19T13:03:57.234156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028820037841796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.blocksdbt.not_null_web_users_user_id.bac3da223d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom OFER_DB.DBT_ds.web_users\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.235203Z", "completed_at": "2025-02-19T13:03:57.237517Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.237720Z", "completed_at": "2025-02-19T13:03:57.237723Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00304412841796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.blocksdbt.unique_web_users_user_id.f689354cfd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom OFER_DB.DBT_ds.web_users\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.238786Z", "completed_at": "2025-02-19T13:03:57.240867Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.241064Z", "completed_at": "2025-02-19T13:03:57.241067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002847909927368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.churn", "compiled": true, "compiled_code": "WITH churned AS (\n  SELECT\n    DATE_TRUNC('day', canceled_at) as churn_day,\n    COUNT(DISTINCT email) as churned_customers,\n    SUM(amount) * 12 as churned_arr\n  FROM OFER_DB.DBT_intermediate.subscriptions\n  WHERE status = 'canceled'\n  GROUP BY 1\n),\nactive AS (\n  SELECT\n    DATE_TRUNC('day', start_date) as day,\n    COUNT(DISTINCT email) as total_customers,\n    SUM(amount) * 12 as total_arr\n  FROM OFER_DB.DBT_intermediate.subscriptions\n  WHERE status = 'active'\n  GROUP BY 1\n)\n\nSELECT\n  a.day,\n  COALESCE(c.churned_customers, 0) as churned_customers,\n  ROUND((COALESCE(c.churned_customers, 0)::float / a.total_customers * 100), 2) as churn_rate,\n  COALESCE(c.churned_arr, 0) as churned_arr,\n  ROUND((COALESCE(c.churned_arr, 0) / a.total_arr * 100), 2) as arr_churn_rate\nFROM active a\nLEFT JOIN churned c ON a.day = c.churn_day\nORDER BY 1", "relation_name": "OFER_DB.DBT.churn", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.241967Z", "completed_at": "2025-02-19T13:03:57.243519Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.243793Z", "completed_at": "2025-02-19T13:03:57.243796Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022420883178710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.current_metrics", "compiled": true, "compiled_code": "WITH current_metrics AS (\n  SELECT\n    COUNT(DISTINCT email) as total_customers,\n    SUM(CASE \n      WHEN interval = 'month' THEN amount\n      WHEN interval = 'year' THEN amount/ 12\n      ELSE 0\n    END) * 12 as current_arr,\n    AVG(CASE \n      WHEN interval = 'month' THEN amount \n      WHEN interval = 'year' THEN amount  / 12\n      ELSE 0\n    END) * 12 as avg_arr_per_customer\n  FROM OFER_DB.DBT_intermediate.subscriptions\n  WHERE status = 'active'\n)\n\nSELECT \n  total_customers,\n  ROUND(current_arr, 2) as current_arr,\n  ROUND(avg_arr_per_customer, 2) as avg_arr_per_customer\nFROM current_metrics", "relation_name": "OFER_DB.DBT.current_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.244812Z", "completed_at": "2025-02-19T13:03:57.246390Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.246597Z", "completed_at": "2025-02-19T13:03:57.246600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023081302642822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.customers_cohorts", "compiled": true, "compiled_code": "WITH cohorts AS (\n  SELECT\n    DATE_TRUNC('day', start_date) as cohort_day,\n    email customer_id,\n    MIN(amount) as initial_mrr\n  FROM OFER_DB.DBT_intermediate.subscriptions\n  WHERE status = 'active'\n  GROUP BY 1, 2\n)\n\nSELECT\n  cohort_day,\n  COUNT(DISTINCT customer_id) as customers,\n  SUM(initial_mrr) * 12 as cohort_arr,\n  AVG(initial_mrr) * 12 as avg_customer_arr\nFROM cohorts\nGROUP BY 1\nORDER BY 1", "relation_name": "OFER_DB.DBT.customers_cohorts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.247682Z", "completed_at": "2025-02-19T13:03:57.249388Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.249694Z", "completed_at": "2025-02-19T13:03:57.249697Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025899410247802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.daily_arr_trends", "compiled": true, "compiled_code": "WITH daily_arr AS (\n  SELECT\n    DATE_TRUNC('day', start_date) AS day,\n    SUM(CASE \n      WHEN interval = 'month' THEN amount \n      WHEN interval = 'year' THEN amount /  12\n      ELSE 0\n    END) * 12 as arr\n  FROM OFER_DB.DBT_intermediate.subscriptions\n  WHERE status = 'active'\n  GROUP BY 1\n  ORDER BY 1\n)\n\nSELECT \n  day,\n  arr,\n  arr - LAG(arr) OVER (ORDER BY day) as arr_change,\n  ROUND(((arr / LAG(arr) OVER (ORDER BY day) - 1) * 100), 2) as growth_rate\nFROM daily_arr", "relation_name": "OFER_DB.DBT.daily_arr_trends", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.250772Z", "completed_at": "2025-02-19T13:03:57.252757Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.252999Z", "completed_at": "2025-02-19T13:03:57.253002Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002810955047607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.two_month_arr", "compiled": true, "compiled_code": "with two_month AS ( \n    SELECT\n        DATEADD(day, -(seq4() + 1), current_date()) AS date\n    FROM\n        TABLE(GENERATOR(ROWCOUNT => 60))\n    WHERE\n        DATEADD(day, -(seq4() +1),current_date()) <= current_date()\n\n)\nSELECT s.*, s.amount*12 arr,   ds.date FROM two_month ds, OFER_DB.DBT_intermediate.subscriptions s\nwhere s.start_date <= ds.date", "relation_name": "OFER_DB.DBT.two_month_arr", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.254026Z", "completed_at": "2025-02-19T13:03:57.255453Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.255691Z", "completed_at": "2025-02-19T13:03:57.255694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021409988403320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.visitors", "compiled": true, "compiled_code": "select * \n    from OFER_DB.DBT_intermediate.funnel_pages \n    where campaign_id is not null \n    order by campaign_id , uuid_ts", "relation_name": "OFER_DB.DBT_intermediate.visitors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.256882Z", "completed_at": "2025-02-19T13:03:57.258861Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.259142Z", "completed_at": "2025-02-19T13:03:57.259145Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002767801284790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.signups", "compiled": true, "compiled_code": "select  v.uuid_ts,\n        v.campaign_id, \n        v.anonymous_id, \n        v.ad_group_id, \n        v.keyword, \n        i.user_id, \n        1 signup , \n        u.goal, \n        u.is_work\nfrom    OFER_DB.DBT_intermediate.visitors v, \n        OFER_DB.DBT_ds.web_identifies i, \n        OFER_DB.DBT_ds.web_users u \n    where v.page_clicks = 1 and v.anonymous_id = i.anonymous_id and i.user_id = u.user_id\n    qualify  ROW_NUMBER() OVER (PARTITION BY v.campaign_id, v.anonymous_id, i.user_id order by v.campaign_id, v.anonymous_id, i.user_id)  = 1", "relation_name": "OFER_DB.DBT_intermediate.signups", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.260393Z", "completed_at": "2025-02-19T13:03:57.262294Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.262505Z", "completed_at": "2025-02-19T13:03:57.262508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002665996551513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.hard_signups", "compiled": true, "compiled_code": "with submited_pages as (\n    select * from OFER_DB.DBT_ds.web_pages \n    where url like '%submitted=true%'\n    qualify  ROW_NUMBER() OVER (PARTITION BY user_id order by user_id) = 1\n) \nselect s.uuid_ts, s.campaign_id, s.ad_group_id, s.keyword, s.anonymous_id, \n        iff(sp.user_id is null, '', s.goal) goal , \n        iff(sp.user_id is null, false, s.is_work) is_work, \n        iff(sp.user_id is null, 0, 1) hard_signup  \n    from               OFER_DB.DBT_intermediate.signups  s\n    left join submited_pages as sp on s.user_id = sp.user_id", "relation_name": "OFER_DB.DBT_intermediate.hard_signups", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.263789Z", "completed_at": "2025-02-19T13:03:57.267385Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.267571Z", "completed_at": "2025-02-19T13:03:57.267573Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0043048858642578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.union_for_funnel", "compiled": true, "compiled_code": "with union_data as (\n    select campaign_id, ad_group_id, keyword, date(date_start) uuid_ts, impressions, clicks, average_cost, \n            to_number(0, 38, 0) visitor , \n            to_number(0, 38, 0) page_clicks, to_number(0, 38, 0) signup , to_number(0, 38, 0) hard_signups, \n            to_number(0, 38, 0) goalwork, to_number(0, 38, 0) work_email \n            from OFER_DB.DBT_intermediate.keywords_data\n        union all\n    select campaign_id, ad_group_id, keyword,  uuid_ts, 0, 0, 0, visitor, page_clicks, 0, 0, 0, 0 \n            from OFER_DB.DBT_intermediate.visitors\n        union all\n    select campaign_id, ad_group_id, keyword,  uuid_ts, 0, 0, 0, 0, 0, signup, 0, 0, 0  \n            from OFER_DB.DBT_intermediate.signups\n        union all\n    select campaign_id, ad_group_id, keyword,  uuid_ts, 0, 0, 0, 0 , 0, 0, hard_signup, iff(goal = 'work', 1, 0) goalwork, iff(is_work = 'true', 1, 0) work_email \n            from OFER_DB.DBT_intermediate.hard_signups\n)\n\nselect * from union_data", "relation_name": "OFER_DB.DBT_intermediate.union_for_funnel", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-19T13:03:57.268768Z", "completed_at": "2025-02-19T13:03:57.270648Z"}, {"name": "execute", "started_at": "2025-02-19T13:03:57.270905Z", "completed_at": "2025-02-19T13:03:57.270908Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002647876739501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.blocksdbt.funnel_data", "compiled": true, "compiled_code": "select c.campaign_name, \n    g.ad_groups_name, \n    f.*, \n    f.clicks*f.average_cost cost  \nfrom    OFER_DB.DBT_intermediate.union_for_funnel f, \n        OFER_DB.DBT_ds.google_ad_groups g, \n        OFER_DB.DBT_ds.google_campaigns c\n    where f.campaign_id = c.campaign_id and f.ad_group_id = g.ad_groups_id and f.campaign_id = g.campaign_id", "relation_name": "OFER_DB.DBT.funnel_data", "batch_results": null}], "elapsed_time": 2.3204779624938965, "args": {"populate_cache": true, "version_check": true, "use_colors": true, "log_level_file": "debug", "empty_catalog": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "macro_debugging": false, "project_dir": "/Users/oferharamati/Development/blocks/bi/etl/airflow/dags/blocksdbt", "state_modified_compare_more_unrendered_values": false, "log_format": "default", "vars": {}, "log_file_max_bytes": 10485760, "invocation_command": "dbt docs generate", "defer": false, "favor_state": false, "indirect_selection": "eager", "profiles_dir": "/Users/oferharamati/.dbt", "partial_parse": true, "show_resource_report": false, "print": true, "select": [], "compile": true, "log_level": "info", "skip_nodes_if_on_run_start_fails": false, "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "exclude": [], "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": false, "strict_mode": false, "log_path": "/Users/oferharamati/Development/blocks/bi/etl/airflow/dags/blocksdbt/logs", "cache_selected_only": false, "partial_parse_file_diff": true, "which": "generate", "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "write_json": true, "static_parser": true, "static": false, "state_modified_compare_vars": false, "use_colors_file": true, "log_format_file": "debug", "printer_width": 80}}